$(document).ready(function(){function t(){e?$.ajax({method:"GET",url:"https://api.lifx.com/v1/lights/all",headers:{Authorization:"Bearer "+e}}).done(function(t){var e=t[0].brightness;$("#brightness").val(e),$("#current-brightness").html(Math.round(100*e)+"%"),a="id:"+t[0].id}):$("#current-brightness").html("")}var e=localStorage.getItem("lifx_app_token"),a="all";$("#lifx_app_token").val(e),$("#save-token").click(function(){$("#lifx_app_token").val()&&(localStorage.setItem("lifx_app_token",$("#lifx_app_token").val()),e=localStorage.getItem("lifx_app_token"),t())}),$("#delete-token").click(function(){localStorage.removeItem("lifx_app_token"),e=localStorage.getItem("lifx_app_token"),$("#lifx_app_token").val(e)}),$("#toggle").click(function(){e?$.ajax({method:"POST",url:"https://api.lifx.com/v1/lights/"+a+"/toggle",data:{duration:$("#duration").val()},headers:{Authorization:"Bearer "+e}}):alert("LIFX personal access token is missing.")}),$("#toggle-0s").click(function(){$("#duration").val(0),$("#toggle").click()}),$("#toggle-1s").click(function(){$("#duration").val(1),$("#toggle").click()}),$("#toggle-5m").click(function(){$("#duration").val(300),$("#toggle").click()}),$("#brightness").on("input change",function(){if(e){var t=$(this).val();$("#current-brightness").html(Math.round(100*t)+"%")}else alert("LIFX personal access token is missing.")}),$("#brightness").on("change",function(){if(e){var t=$(this).val();$.ajax({method:"PUT",url:"https://api.lifx.com/v1/lights/"+a+"/state",data:{power:"on",brightness:t,duration:"0",fast:!0},headers:{Authorization:"Bearer "+e}})}else alert("LIFX personal access token is missing.")}),t()});